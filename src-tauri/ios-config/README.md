# iOS Build Configuration

This directory contains configuration files needed for iOS builds.

## Files

### ExportOptions.plist
This file specifies how the iOS app should be exported for App Store distribution. It's used by `xcodebuild -exportArchive` command during the CI/CD build process.

**Key settings:**
- **method**: `app-store` - Builds for App Store distribution
- **teamID**: `PCJU8QD9FN` - Apple Developer Team ID
- **signingStyle**: `manual` - Manual code signing (using provisioning profiles from secrets)
- **provisioningProfiles**: Maps bundle ID to provisioning profile name
- **uploadSymbols**: `true` - Upload crash report symbols to App Store Connect

## Usage

During the iOS build workflow (`.github/workflows/ios-release.yml`), this file should be copied to `src-tauri/gen/apple/ExportOptions.plist` after running `cargo tauri ios init`.

Add this step to the workflow:
```yaml
- name: Copy ExportOptions.plist
  run: |
    cp src-tauri/ios-config/ExportOptions.plist src-tauri/gen/apple/ExportOptions.plist
```

## Local Development

If you're building iOS locally on macOS:

1. Initialize the iOS project:
   ```bash
   cargo tauri ios init
   ```

2. Copy the export options:
   ```bash
   cp src-tauri/ios-config/ExportOptions.plist src-tauri/gen/apple/
   ```

3. Build the app:
   ```bash
   cargo tauri ios build --release
   ```

## Xcode Cloud Setup

If building via **Xcode Cloud** (Apple's CI/CD):

1. The `ci_scripts/ci_pre_xcodebuild.sh` script is automatically executed before the Xcode build
2. This script runs:
   - `cargo tauri ios init` - Generates the iOS workspace at `src-tauri/gen/apple/`
   - Copies `ExportOptions.plist` to the generated location
   - Installs CocoaPods dependencies
3. Xcode Cloud then builds using the generated workspace

**Important:** Xcode Cloud requires scripts in the `ci_scripts/` directory to follow specific naming conventions:
- `ci_pre_xcodebuild.sh` - Runs before the Xcode build
- `ci_post_xcodebuild.sh` - Runs after the Xcode build
- `ci_post_clone.sh` - Runs after cloning the repository

## Notes

- The `gen/apple` directory is generated by Tauri and is git-ignored
- This template file ensures consistent export settings across all iOS builds
- Update the `teamID` and `provisioningProfiles` if the Apple Developer account changes
- The pre-build script must have execute permissions: `chmod +x ci_scripts/ci_pre_xcodebuild.sh`
